<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <link rel="apple-touch-icon" sizes="76x76" href="/static/node_modules/material-kit/assets/img/apple-icon.png">
  <link rel="icon" type="image/png" href="/static/node_modules/material-kit/assets/img/favicon.png">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>
    Supereye
  </title>
  <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport'
  />
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons"
  />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
  <link href="/static/node_modules/material-kit/assets/css/material-kit.css?v=2.0.4" rel="stylesheet" />
  <link href="/static/node_modules/material-kit/assets/demo/demo.css" rel="stylesheet" />
  <style>
    html,
    body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
  </style>
</head>

<body class="h-100 index-page sidebar-collapse bg-primary">
  <div class="h-100 container">
    <div class="row h-25">
      <div class="col">
        <div class="brand">
          <h1>Super eye</h1>
          <h3>advertising creative recognition system</h3>
        </div>
      </div>
    </div>

    <div class="row h-25 align-items-center justify-content-center">
      <form class="w-100" id="recognitionForm">
        <div class="row justify-content-center align-items-center">
          <div class="col-md-4 col-3 text-right">
            <label class="btn btn-white btn-raised btn-fab btn-round" for="imageUploader">
              <input id="imageUploader" type="file" name="file" style="display:none;">
              <i class="material-icons">photo_camera</i>
            </label>
          </div>
          <div class="col-md-4 col-6">
            <input type="text" class="form-control form-control-lg" placeholder="" id="imageUrl">
          </div>
          <div class="col-md-4 col-3  ml-auto mr-auto">
            <!-- <label class="btn btn-white btn-raised btn-fab btn-round" id="searchBtn">
              <i class="material-icons">search</i>
            </label> -->
            <button type="submit" class="btn btn-white btn-raised btn-fab btn-round">
              <i class="material-icons">search</i>
            </button>
          </div>
        </div>
      </form>
    </div>

    <div class="row h-40 align-items-center justify-content-center">
      <div class="card text-center" style="width: 20rem;">
        <div class="card-body d-none" id="cardBody">
          <h4 class="card-title" id="result">PASS</h4>
        </div>
        <img class="card-img-bottom" src="" alt="" id="photoFrame" />
      </div>
    </div>
  </div>

  <div class="modal fade" id="unspportFormat" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Warnning</h5>
        </div>
        <div class="modal-body">
          <p>only support image format: png/jpg/jpeg/gif/mp4/avi/mov</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <script src="/static/node_modules/material-kit/assets/js/core/jquery.min.js" type="text/javascript"></script>
  <script src="/static/node_modules/material-kit/assets/js/core/popper.min.js" type="text/javascript"></script>
  <script src="/static/node_modules/material-kit/assets/js/core/bootstrap-material-design.min.js" type="text/javascript"></script>
  <script src="/static/node_modules/material-kit/assets/js/plugins/moment.min.js"></script>
  <script src="/static/node_modules/material-kit/assets/js/plugins/bootstrap-datetimepicker.js" type="text/javascript"></script>
  <script src="/static/node_modules/material-kit/assets/js/plugins/nouislider.min.js" type="text/javascript"></script>
  <script src="/static/node_modules/material-kit/assets/js/plugins/jquery.sharrre.js" type="text/javascript"></script>
  <script src="/static/node_modules/material-kit/assets/js/material-kit.js?v=2.0.4" type="text/javascript"></script>
  <script>
    $(document).ready(function () {
      materialKit.initFormExtendedDatetimepickers();
      materialKit.initSliders();
    });

    $(document).ready(function () {
      $('#imageUploader').on('change', function () {
        var filePath = $(this).val();
        var fileFormat = filePath.substring(filePath.lastIndexOf(".")).toLowerCase();
        var src = window.URL.createObjectURL(this.files[0]);
        if (!fileFormat.match(/.png|.jpg|.jpeg|.gif|.mp4|.avi|.mov/)) {
          $('#unspportFormat').modal();
          return;
        }
        $('#cardBody').addClass("d-none");
        $('#photoFrame').attr('src', src);
      });

      $('#recognitionForm').on('submit', (function (e) {
        e.preventDefault();
        var formData = new FormData(this);
        $.ajax({
          type: 'POST',
          url: "/recognition",
          data: formData,
          cache: false,
          contentType: false,
          processData: false,
          dataType: "json",
          success: function (data) {
            console.log(data);
            if (data["status"] != 0) {
              console.log("error");
              return;
            }
            if (data["recognition"]) {
              $('#result').text("PASS");
            } else {
              $('#result').text("FAIL");
            }
            $('#cardBody').removeClass("d-none");
          },
          error: function (data) {
            console.log("error");
            console.log(data);
          }
        });
      }));
    });
  </script>
</body>

</html>